module Day_03
  ( solution,
  )
where

solution :: (Maybe String, Maybe String)
solution =
  let grid = (createRightInfiniteGrid input)
      start = (0, 0)
   in ( Just . show $ toboggan grid start (3, 1) 0,
        Just . show $
          foldr (*) 1 $
            [ toboggan grid start (1, 1) 0,
              toboggan grid start (3, 1) 0,
              toboggan grid start (5, 1) 0,
              toboggan grid start (7, 1) 0,
              toboggan grid start (1, 2) 0
            ]
      )

toboggan :: Grid -> Point -> Gradient -> Int -> Int
toboggan grid (x, y) (dx, dy) numberOfTrees
  | length grid < y + 1 = numberOfTrees
  | otherwise =
    toboggan
      grid
      (x + dx, y + dy)
      (dx, dy)
      (if (isTree grid (x, y)) then numberOfTrees + 1 else numberOfTrees)

createRightInfiniteGrid :: Grid -> Grid
createRightInfiniteGrid g = map cycle g

isTree :: Grid -> Point -> Bool
isTree grid (x, y) =
  let cell = grid !! y !! x
   in cell == '#'

type Grid = [[Char]]

type Point = (Int, Int)

type Gradient = (Int, Int)

input =
  [ "...............#.#.............",
    "##..#....................#...##",
    "......#..#.#.....#..#.#.##.....",
    ".........#...#..............#.#",
    "............#.......##.........",
    "...#.....#.....#...#.....#..#..",
    "..............#..##.#..#......#",
    ".##.....#.....#......##.#......",
    ".#..........###....#...##....#.",
    ".....#....#.#.......#......##..",
    ".#....#......#.......#........#",
    "..#.#.......#..##.....##.......",
    "...#.#....#.......#.......#...#",
    "##.##...##..#......#.#.....#..#",
    ".#.#.......#..#.#......#...#.#.",
    "#.......##.......#...#.........",
    ".....#......#.#.#.....#....##..",
    ".#.#........#....#..#..#.......",
    "...#....#..###.........#.....#.",
    "........#........#........#....",
    "..##..............#.....#.#..#.",
    ".#...##.............#.#........",
    "....#..#...........#.......#...",
    "..#....#.....................#.",
    "#.#..................##......##",
    ".#.##....#......#........#.....",
    ".........##.....#....#...##..#.",
    "#..........#..#.#.............#",
    ".........#...#.#.#.#..##..##...",
    "#...#.....#..#..#....#...#.....",
    "..##.....#..................#..",
    "#..###.....#....#.......#..#...",
    "...##.##..#............#......#",
    "........###.........###......#.",
    "#..##....#.........#.........#.",
    "....#.....................#....",
    "#..#..##..#..####.##..#.....##.",
    "..#...#.#....#....##.....#.....",
    "...#.#.........#.....#.#.......",
    "....#................#..#...##.",
    "....#..#..........#...#.#.##...",
    "........#..##............#....#",
    "...#......##..........#.##...#.",
    ".......##......................",
    ".......##..........#....#.#...#",
    "......###.##..##..#....#...#..#",
    "#.#...........##.....#........#",
    "..#...........#..###....#.#.#..",
    "........#...........#......##..",
    ".........#...##.###...###..#...",
    ".....#.....#..##.........##....",
    "...##..............#.....#...##",
    ".##....#.......###.....#.......",
    ".#...........##.............##.",
    "......#..#..##.##......#......#",
    "........###........#......#.#..",
    "#.#....#.....#........#......#.",
    ".##..#.........##...##....#....",
    ".....#.........#...##.....#....",
    ".............#........###....#.",
    "......#.......#.#........#.#...",
    "..#....#.#...#....#...#.#...##.",
    "#...#......##..##......#.##.###",
    "...##.#....#...#....#.........#",
    "...#..####.....##.#..#.#...##..",
    "##.#..#....##......#......##...",
    "###.........#.#..#.#.....#.....",
    "...#........#..##...#.#.#..#.#.",
    "...###..#.###.#...#............",
    "....................###........",
    "...........#...........#.......",
    "#..............#.#.........###.",
    "....................##.....#..#",
    "#.#.....#.......#...#..........",
    ".#...#......#....##...#...#....",
    ".....#.##..................###.",
    ".........#.#..#.#......#.......",
    ".......#.....##..#.##.#........",
    "..#..........#.###.....#....#..",
    "......#.............#.#........",
    "........##....#........#.......",
    "...#.............#....#.#......",
    "#........#..####.....#.....#.#.",
    ".##......##...#........#..#.#..",
    "....##....#...#...#..##...#.#..",
    "#.##...###..#....##.#..........",
    "....#.#...#.#...#..##.###...#..",
    "#.....##..#..#....#.#.....##...",
    ".#..#..........##.#.....##.....",
    ".#..#........#.#.#.#...........",
    ".#..#.....#...........#...#....",
    "...#......##..........##..#....",
    "...#..#....#.##...#..#.....###.",
    "#.#....#.....##................",
    "#..#......#.#.#.......#........",
    "......#....#.#....#..##....#..#",
    ".#.....#.#....###.##.........#.",
    ".###..#.....#........#.#.......",
    ".#...#......#..#.#......#.....#",
    "#...............####...#.....#.",
    ".......#..........##.#........#",
    "#........##....##.....###..##..",
    "#..#.....#..##.....#....#..#...",
    "#.....#.......##......#.#.....#",
    "#.##..#......##..#.............",
    "##...#.....#........##.........",
    "....#..##....#...#.......#.#...",
    "....#...#...##..#....#..#...#..",
    "..............#.#...#....###...",
    "...#....#..##...##..#....##....",
    "#.##.#..#..#......#.#.#.#...#..",
    ".......#..#..##........#......#",
    "##.#....#....##.#......##.#....",
    ".#...#..............#........#.",
    ".#.#....#.........#............",
    ".#..#..###.............#....#..",
    "#......#...#.#..##..#...#....#.",
    ".......................#...#.#.",
    ".............#..#...##.........",
    "..#.#..#....#....#........#....",
    "#......#.##..#...#.#...........",
    ".....#....#...........##.#..#..",
    "..#.#.....#..............#.#...",
    "#.......#.....#................",
    "#..............#...#....#...#..",
    "...#...##..#..#............#...",
    "......###.....................#",
    ".........#.......##..#....#....",
    "........#...#.##..#.##......#..",
    "....###..#.#...#...#..#.#...###",
    "##...#...##.#...#.#...#.#....#.",
    ".........#...#.....###.........",
    "...#........##..#.......##.....",
    ".#.......##.........#.....##..#",
    ".#..................#...#......",
    ".##..#..#.#.....#.###..........",
    "...#.....##..#.........#...#...",
    ".#......#.#.......#.#..........",
    ".........#.#...#..........#.#..",
    "#..........#.##..#.##....#.....",
    ".#.#....#.....#..##.....#...#..",
    "..#........##...##..#..#....#..",
    "#...........##....#..###....#..",
    "...........##.........####...#.",
    "..#........###...#.#.........#.",
    ".#...............#.##.#.#...#..",
    ".#.##..#.....#.#.....##..#.....",
    "...#...#..#.##.##...#.......##.",
    "..#...#...#......##.##.##...#..",
    "##....#...#...#...............#",
    "...##...........#......#..#.#..",
    "#.........#......#.#.##.....#..",
    "........#..#.........##........",
    "..#.#....###.....##..#...#.....",
    ".........#...#.......#.....##..",
    "##.....................#...##..",
    ".#.#..#......#.................",
    ".....###..#......#..###..#.....",
    "...#.....##.........#......#..#",
    "......##.....#...#........#.#..",
    "..#.#...#......#...#.##.##.....",
    "...#..........#...#.......#..##",
    ".###........#........##........",
    "..#.#.#..........#.#...##......",
    ".........#........#......###..#",
    "....##..#.........#...........#",
    "..####..#............##.......#",
    ".....##.#..##.........#...#.#..",
    "...#.........#.....#.....#.....",
    ".......#...#..#...##.........#.",
    "...#...#..#...#....#..#........",
    "#............##.##...#.........",
    ".#.#.....#.......####.....#....",
    "..............#......#.#.......",
    "..............#...........#...#",
    "#...#........###....#.#....#.#.",
    "##.#..#..#......#......#.#.#...",
    ".#..#.....#..#.#..#.#.......##.",
    "......##.#...#...#......#...#..",
    "#...........##....#.#..........",
    "....#.......###.#...#..........",
    ".......................#.....#.",
    "........#...#..#...#.#.#.#.#...",
    ".#.#...........#......##...#...",
    ".........................#.....",
    ".................#.##.#...##...",
    "...#...##.....#.....##....#.#..",
    "...#...#...................#...",
    "...#..#..#...#...#....#........",
    "#....#...#.....#...............",
    ".......#...........#...#.......",
    "....#....#.....##.......#......",
    ".......#..........##...........",
    ".#.#........#..##....#......#..",
    ".....#.......#.#.........#...#.",
    ".#..####.#.#...............#..#",
    ".....###..#..#..........#.#..##",
    "..#.......#...#.....##..#..#.#.",
    "#....#......#..................",
    "........#.##.#....#...........#",
    "....#.#....##..#.#.....##......",
    "...#..#.......#....#.....#.#.#.",
    "#...#......#.....#.#..........#",
    "....#....#...............#.....",
    "..###......................###.",
    ".##....#..#.......###.....#..#.",
    "..###............#........#.##.",
    ".#........#......#.....#..#....",
    "....#..##...#...#.###.......#.#",
    ".......#.##...........#.#..#...",
    ".....#...##....................",
    "....#....#...##......#.........",
    "..#............##....###.#...#.",
    ".#........#...............#....",
    "#..#.#.##.........#..##....##..",
    "#.#....#..#.##....##...#.#.....",
    ".....#.....##....#.#........#..",
    "#..#...#...#....#....#.........",
    "...#........#..#.#.....##......",
    "..#...#...#................##..",
    "#........#.#.##.......#.#...#..",
    "#......#..####.##.....#.#..#.#.",
    "............#..#.#....#......##",
    "..#.....##....#...#.#..........",
    "...#...#.........#...#.#.......",
    ".###..#.......##.##.....#.#.#..",
    "...#....#...............##.#...",
    "....##..#..#..#.#......##.....#",
    "#.#..............##...##...####",
    ".....#.##...#.#...............#",
    ".##.....#.........#.......#.#.#",
    "#.#..#.....#.......#.......#..#",
    "...#.#.....#.....#......#......",
    ".......#....#..#.#..........#..",
    "......#......#.##...#..........",
    ".....#.......###...#...#.#.....",
    "#..#.#.........#.....#.##....#.",
    "..#.#.........#..#..#..#.....#.",
    ".#..##..#..#....#......#.##..#.",
    "...##......###.....#.##.##.....",
    ".#.....#...#..#...#............",
    "##..##..#.##....#..#...........",
    "...#..##..#..#.............#.##",
    "...............##............#.",
    "..#.....##........##.#...#....#",
    ".#.#...#.#.#..#.#.....#....#...",
    ".#....#...............#..#.....",
    "....#.##..#....#......#...###..",
    "#................###...#.#.....",
    "...#...#......##..#.#....#.....",
    ".#....#....#.#...##............",
    "....#...##..#..#........#.##...",
    "..##.....#..#..##..............",
    "..#..##..#.#..##....#....#....#",
    "...##.............#............",
    "#....#....#.#........#.....##.#",
    ".....#..#.#.....####...###.....",
    "................#......#.......",
    ".....#.#.#.#.#....#..#........#",
    ".##.#...#.#.......##....#....#.",
    ".....#........#................",
    "..#.....#..#...#..#...........#",
    ".#.....#...##.....##..#.#....##",
    "......#.......#..#......##.#...",
    "#.#..........#.##.#........#...",
    "...#..#.............#..........",
    "#..#..#..........#..##.#.......",
    ".#..#...............####..#....",
    ".......#.....#......#.....#.#..",
    ".#...............#...#.........",
    ".#..#..........#..#.#..##..#..#",
    "......##..#.....#..#......###..",
    "..........#...#..#.......#.....",
    ".#.#.#..#.....#.##.#...#..#....",
    "........#.......#.....#.#......",
    "......#.....##.....#....##.#...",
    "...............#......#.......#",
    "..#.#...#.....#.#...##......#..",
    "#.#.........#.#...#........####",
    "#..........##..#..#........##..",
    ".............#..#.......##.#..#",
    "..#........#.#....#........#.#.",
    ".#......####..#..#.............",
    "............###.......#.#..#...",
    "#.##......##...#...#.........#.",
    "....##.#.#.#......#....#..#...#",
    ".#..#.#....#...#.........#.....",
    "#...#.....##............#...#..",
    "#.#...#..#.................#...",
    "............#.#..#.....#.#.#..#",
    "...................#....#.##...",
    ".....#...#.#....#....#.#......#",
    ".......##.#.#......##..........",
    ".#..#...##.#...#..#......#.....",
    "......#.#..#..###..##..##......",
    ".#.#.#.#.....#...###.....#..#..",
    ".#....#.....#.......#.......#..",
    "..........##.........####......",
    ".#.#.............#..#.#...#....",
    "........#........##...#.#....#.",
    "........#......................",
    "..#.#....#...............#...##",
    ".......#.#...#..#.....##......#",
    ".#...#....#..........##........",
    ".#.........#.#............##...",
    ".....#......##...#.......#..#..",
    "#.#..#.............#...#...#...",
    "......#.......#............#...",
    "...........##....#......##.....",
    ".#.#..#.....................#..",
    "##..##.....###..##.#...........",
    "...##......##....#...##.....#..",
    "#...#.##.............#.........",
    "......#..#.........###.#......#",
    "#.#.....#.....................#",
    "....#####.....##........#.#..#.",
    "...........##..##.###..........",
    "..........##.....#........#...#",
    ".......#..#......#.....##..##.#",
    ".....##.#........#.........#...",
    "......##......................#",
    ".#.......#.#.#............#..#.",
    ".....##.#.......#.#........#..."
  ]

testInput =
  [ "..##.......",
    "#...#...#..",
    ".#....#..#.",
    "..#.#...#.#",
    ".#...##..#.",
    "..#.##.....",
    ".#.#.#....#",
    ".#........#",
    "#.##...#...",
    "#...##....#",
    ".#..#...#.#"
  ]
